==================
创建项目
==================

创建一个新目录。

进入该目录并从命令行运行：

.. code-block:: console

    $ jam-project.py

对于 Windows 用户，``jam-project.py`` 命令位于 ``Scripts`` 文件夹中，即该目录的上层文件夹：

.. code-block:: console

    ...\> ..\project-name\Scripts\jam-project.py


目录中将创建以下文件和文件夹：::

    /
        css/
        js/
        reports/
        static/
        locks/
        admin.sqlite
        langs.sqlite
        server.py
        index.html
        templates.html
        wsgi.py


要启动 Jam.py Web 服务器，请运行 ``server.py`` 脚本。


.. code-block:: console

    $ ./server.py


对于 Windows 用户：

.. code-block:: console

    ...\>server.py


.. note::
    你可以指定端口作为参数，例如：
    
    .. code-block:: console
    
        $ ./server.py 8081
        
    默认端口是 8080。如果你指定了其他端口，在后续步骤中需要在浏览器中使用该端口。


你将在命令行上看到类似输出：::

    User Guide: https://jampy-docs-v7.readthedocs.io/
    WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
     * Running on all addresses (0.0.0.0)
     * Running on http://127.0.0.1:8080
     * Running on http://127.0.0.1:8080
    Press CTRL+C to quit


如果我们打开 Web 浏览器访问该应用，将显示以下信息：


.. image:: _images/run_builder_jampy.png
	:alt: Jam.py 新项目


打开 Web 浏览器，访问本地域名的 "/builder.html" —— 例如：

.. code-block:: console

    127.0.0.1:8080/builder.html
    
你应该会看到语言选择对话框。这定义了用户界面使用的语言。你可以从默认语言列表中选择语言，或者使用输入字段右侧的"文件夹"图标导入自己的语言文件。更多信息请参阅
:doc:`语言支持 </admin/language_support>` 页面。
选择你的语言，然后点击确定按钮。

.. image:: _images/lang_jampy.png
	:alt: Jam.py 语言对话框

接下来是新项目对话框。请填写：

* **Caption** - 将向用户显示的项目名称。
* **Name** - 项目（任务）的名称，将在代码（Python 或 JS）中用于访问任务对象。这应是一个简短且有效的 Python 标识符。在项目数据库中创建表时，此名称也用作前缀。
* **DB type** - 选择数据库类型。如果数据库不是 Sqlite，必须提前创建，并在相应的表单字段中输入其属性。
  查看数据库设置示例，请访问 :doc:`此链接 </admin/project/database>`。

.. image:: _images/project_params_jampy.png
	:align: center
	:alt: 新项目设置

点击确定后，将检查数据库连接，如果失败则会显示错误消息。


数据库设置示例
===========================

.. admonition:: 改编自 `Jam.py Design Tips`_

    Jam.py 支持多种不同的数据库服务器。例如 PostgreSQL_、MariaDB_、MySQL_、MSSQL_、Oracle_、Firebird_、IBM_、SQLite_、Databricks_ 以及使用 SQLCipher_ 的 SQLite。

    如果你正在开发一个小型项目或不打算在生产环境中部署的内容，SQLite 通常是最佳选择，因为它不需要运行单独的服务器。然而，SQLite 与其他数据库有许多不同之处，因此如果你正在开发一个重要的项目，建议使用与生产环境计划相同的数据库进行开发。


    除了数据库后端，我们还需要确保安装了 Python 数据库绑定。

    * 如果使用 PostgreSQL，需要 ``psycopg2`` 或 ``psycopg2-binary`` 包。
    * 如果使用 MySQL 或 MariaDB，Python 2.x 需要 ``MySQLdb``。对于 Python 3.x，需要 ``mysql-connector-python`` 和 ``mysqlclient`` 包，以及数据库客户端开发文件。
    * 如果使用 MSSQL，需要 ``pymssql``。
    * 如果使用 Oracle，需要 `cx_Oracle`_ 以及 Python 头文件（开发文件）。
    * 如果使用 SQLCipher_（待补充），Linux 需要 ``sqlcipher3-binary`` 包。Windows 有独立的 DLL 可用。
    * 如果使用 IBM_（待补充），需要 ``ibm_db`` 和 ``ibm_db_dbi`` 包。
    * 如果使用 Firebird，需要 ``fdb`` 包。
    * 如果使用 Databricks，需要 ``databricks-sql-connector``。
    * 要生成报告，必须安装 **LibreOffice**。


.. _Jam.py Design Tips: https://jampy-application-design-tips.readthedocs.io/
.. _PostgreSQL: https://www.postgresql.org/
.. _MariaDB: https://mariadb.org/
.. _MySQL: https://www.mysql.com/
.. _psycopg2: https://www.psycopg.org/
.. _SQLite: https://www.sqlite.org/
.. _cx_Oracle: https://oracle.github.io/python-cx_Oracle/
.. _Oracle: https://www.oracle.com/
.. _MSSQL: https://www.microsoft.com/en-au/sql-server/sql-server-downloads
.. _Firebird: https://firebirdsql.org/
.. _SQLCipher: https://github.com/sqlcipher
.. _IBM: https://www.ibm.com/support/pages/downloading-ibm-db2-version-115-linux-unix-and-windows
.. _Databricks: https://www.databricks.com/blog/how-use-lakebase-transactional-data-layer-databricks-apps
    
.. note::

    对于 **SQLite** 数据库，当删除或重命名字段，或创建外键时，
    :doc:`应用程序构建器 </admin/index>`
    会创建一个新表并将记录从旧表复制到其中。
    
    对于 **SQLite** 数据库，Jam.py 不支持将元数据导入到现有项目（数据库中已有表的项目）中。
    你只能将元数据导入到新项目中。

关于数据库设置的更多信息，请参阅 :doc:`项目管理 </admin/project/database>`。



如果一切顺利，将创建一个新项目，项目树将显示在应用程序构建器中。


.. image:: _images/adm_new_project_jampy.png
	:align: center
	:alt: Jam.py 应用程序构建器


.. important::

        如右上角所示，显示应用程序的名称、使用的数据库名称、应用程序版本号以及
        ``Jam.py`` 框架的 ``版本`` 号。


现在，要查看项目本身，请在浏览器中新建一个页面，并在地址栏中输入：

.. code-block:: console

    127.0.0.1:8080


.. image:: _images/empty_project_jampy.png
	:align: center
	:alt: Jam.py 项目

