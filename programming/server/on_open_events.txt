==============
on_open_events
==============

当在 :doc:`客户端 </refs/client/item/m_open>` 或
:doc:`服务器端 </refs/server/item/m_open>` 调用项目的 ``open`` 方法时，
服务器应用程序执行以下代码：

.. code-block:: py

  result = None
  if self.task.on_open:
      result = self.task.on_open(self, params)
  if result is None and self.on_open:
      result = self.on_open(self, params)
  if result is None:
      result = self.execute_open(params)

它会检查任务是否有 ``on_open`` 事件处理程序。如果 ``on_open``
事件处理程序声明在任务服务器模块中，则执行它。

如果任务的 ``on_open`` 事件处理程序未声明或事件处理程序的结果
返回 ``None``，该方法会检查项目是否有
:doc:`on_open </refs/server/item/on_open>`
事件处理程序。如果它声明在项目服务器模块中，则执行它。

如果项目事件处理程序返回的结果是 ``None``，则调用项目的
``execute_open`` 方法，该方法会生成 SQL 查询，
执行它并返回结果。

示例
=======

:doc:`这是一个如何使用 on_open 的示例 </how_to/how_to_multitenancy>`
