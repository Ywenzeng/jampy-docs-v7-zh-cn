==============
记录锁定
==============

在 Jam.py 应用程序中，您可以在用户同时编辑记录时实现记录锁定。

Jam.py 使用乐观锁定模型，也称为乐观并发控制。

当应用程序执行
:doc:`edit_record </refs/client/item/m_edit_record>`
方法时，它会从服务器接收记录的当前版本并
保存它。当用户开始保存记录时，服务器应用程序会检查
记录的当前版本。如果它与存储的值不同（另一
个用户在编辑记录时更改了它），
应用程序会警告用户并禁止保存。

这个记录锁定机制非常容易实现。

为此，请创建一个用于存储记录版本的表字段。
字段类型为 ``integer``（整数）。

之后，我们可以在
:doc:`项目编辑器对话框 <items/item_editor_dialog>` 中设置 **Edit lock** （编辑锁定）属性：

.. image:: _images/item_editor_dialog_jampy.png
	:align: center
	:alt: 保持历史属性

为锁定记录显示的消息：

.. image:: _images/record_locking_msg_jampy.png
	:scale: 50%
	:align: center
	:alt: 锁定记录消息
